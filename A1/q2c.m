% Question 2c solution
u = [0; 0; 0; 0; 0; 0; 0; 0.9571; 1.8616; 2.6060; 3.0360; 3.1714; 0; 1.9667; 3.8834; 5.5263; 6.3668; 6.6135; 0; 3.0262; 6.1791;
    9.2492; 10.2912; 10.5490; 0; 3.9590; 8.5575; 15.0000; 15.0000; 15.0000; 0; 4.2525; 9.0919; 15.0000];

mesh1 = [7 1 2 8];
mesh2 = [8 2 3 9];
mesh3 = [9 3 4 10];
mesh4 = [10 4 5 11];
mesh5 = [11 5 6 12];

mesh6 = [13 7 8 14];
mesh7 = [14 8 9 15];
mesh8 = [15 9 10 16];
mesh9 = [16 10 11 17];
mesh10 = [17 11 12 18];

mesh11 = [19 13 14 20];
mesh12 = [20 14 15 21];
mesh13 = [21 15 16 22];
mesh14 = [22 16 17 23];
mesh15 = [23 17 18 24];

mesh16 = [25 19 20 26];
mesh17 = [26 20 21 27];
mesh18 = [27 21 22 28];
mesh19 = [28 22 23 29];
mesh20 = [29 23 24 30];

mesh21 = [31 25 26 32];
mesh22 = [32 26 27 33];
mesh23 = [33 27 28 34];


%mesh_arr = [mesh1; mesh2; mesh3; mesh4; mesh5; mesh6; mesh7; mesh8; mesh9; mesh10; mesh11; mesh12; mesh13; mesh14; mesh15; mesh16; mesh17; mesh18; mesh19; mesh20; mesh21; mesh22; mesh23];
mesh_arr = [7 1 2 8; 8 2 3 9; 9 3 4 10; 10 4 5 11; 11 5 6 12; 13 7 8 14; 14 8 9 15; 15 9 10 16; 16 10 11 17; 
    17 11 12 18; 19 13 14 20; 20 14 15 21; 21 15 16 22; 22 16 17 23; 23 17 18 24; 25 19 20 26; 26 20 21 27; 
    27 21 22 28; 28 22 23 29; 29 23 24 30; 31 25 26 32; 32 26 27 33; 33 27 28 34];

s = [1 -0.5 .5 -0.5;
    -0.5 1 0.5 0;
    0.5 0.5 1 0.5;
    -0.5 0 0.5 1];

W = zeros(length(mesh_arr), 1);
Wtot = 0

% calculate the capacitance per unit length of the square coaxial cable
for i=1:23
   mesh_i = mesh_arr(i,:)
   U = [u(mesh_i(1)); u(mesh_i(2)); u(mesh_i(3)); u(mesh_i(4))]
   W(i) = 1/2*transpose(U)*s*U;
   Wtot = Wtot + W(i);
end

e0 = 8.854e-12;
V = 15 - 0;
C_l = 2*Wtot*e0/V^2


